1964,	13005,
1965,	6799,
1966,	7717,
1967,	9718,
1968,	4810,
1969,	3285,
1970,	4249,
1971,	3036,
1972,	3287,
1973,	1759,
1974,	2402,
1975,	1738,
1976,	1010,
1977,	2177,
1978,	2063,
1979,	1623,
1980,	1730,
1981,	1248,
1982,	1895,
1983,	2463,
1984,	2276,
1985,	3589,
1986,	4195,
1987,	2823,
1988,	3450,
1989,	4157,
1990,	4570,
1991,	2719,
1992,	4083,
1993,	6586,
1994,	4617,
1995,	5137,
1996,	7796,
1997,	6564,
1998,	7405,
1999,	7298,
2000,	7867,
2001,	7580,
2002,	9771,
2003,	11647,
2004,	25827,
2005,	25616,
2006,	15632,
2007,	10454,
2008,	13278,
2009,	16858,
2010,	27550,
2011,	18719,
2012,	48277,
2013,	28639,
2014,	32971,
2015,	20762,
2016,	17972,
2017,	18975,
2018,	15609,
2019,	18617
)
tibble::tribble(
~X,          ~Location, ~Min, ~Max,
"Partly cloudy.",         "Brisbane",   19L,   29L,
"Partly cloudy.", "Brisbane Airport",   18L,   27L,
"Possible shower.",       "Beaudesert",   15L,   30L,
"Partly cloudy.",        "Chermside",   17L,   29L,
"Shower or two. Possible storm.",           "Gatton",   15L,   32L,
"Possible shower.",          "Ipswich",   15L,   30L,
"Partly cloudy.",    "Logan Central",   18L,   29L,
"Mostly sunny.",            "Manly",   20L,   26L,
"Partly cloudy.",    "Mount Gravatt",   17L,   28L,
"Possible shower.",            "Oxley",   17L,   30L,
"Partly cloudy.",        "Redcliffe",   19L,   27L
)
cdc <- tibble::tibble(
~Year,	~No._Reported_Pertussis_Cases,
1922,	107473,
1923,	164191,
1924,	165418,
1925,	152003,
1926,	202210,
1927,	181411,
1928,	161799,
1929,	197371,
1930,	166914,
1931,	172559,
1932,	215343,
1933,	179135,
1934,	265269,
1935,	180518,
1936,	147237,
1937,	214652,
1938,	227319,
1939,	103188,
1940,	183866,
1941,	222202,
1942,	191383,
1943,	191890,
1944,	109873,
1945,	133792,
1946,	109860,
1947,	156517,
1948,	74715,
1949,	69479,
1950,	120718,
1951,	68687,
1952,	45030,
1953,	37129,
1954,	60886,
1955,	62786,
1956,	31732,
1957,	28295,
1958,	32148,
1959,	40005,
1960,	14809,
1961,	11468,
1962,	17749,
1963,	17135,
1964,	13005,
1965,	6799,
1966,	7717,
1967,	9718,
1968,	4810,
1969,	3285,
1970,	4249,
1971,	3036,
1972,	3287,
1973,	1759,
1974,	2402,
1975,	1738,
1976,	1010,
1977,	2177,
1978,	2063,
1979,	1623,
1980,	1730,
1981,	1248,
1982,	1895,
1983,	2463,
1984,	2276,
1985,	3589,
1986,	4195,
1987,	2823,
1988,	3450,
1989,	4157,
1990,	4570,
1991,	2719,
1992,	4083,
1993,	6586,
1994,	4617,
1995,	5137,
1996,	7796,
1997,	6564,
1998,	7405,
1999,	7298,
2000,	7867,
2001,	7580,
2002,	9771,
2003,	11647,
2004,	25827,
2005,	25616,
2006,	15632,
2007,	10454,
2008,	13278,
2009,	16858,
2010,	27550,
2011,	18719,
2012,	48277,
2013,	28639,
2014,	32971,
2015,	20762,
2016,	17972,
2017,	18975,
2018,	15609,
2019,	18617
)
tibble::tibble(
~X,	         ~Location,	~Min,	~Max,
"Partly cloudy.",	        "Brisbane",	  19,	  29,
"Partly cloudy.",	"Brisbane Airport",	  18,	  27,
"Possible shower.",	      "Beaudesert",	  15,	  30
)
tibble::tribble(
~Year,          ~Location, ~Min, ~Max,
"Partly cloudy.",         "Brisbane",   19L,   29L,
"Partly cloudy.", "Brisbane Airport",   18L,   27L,
"Possible shower.",       "Beaudesert",   15L,   30L,
"Partly cloudy.",        "Chermside",   17L,   29L,
"Shower or two. Possible storm.",           "Gatton",   15L,   32L,
"Possible shower.",          "Ipswich",   15L,   30L,
"Partly cloudy.",    "Logan Central",   18L,   29L,
"Mostly sunny.",            "Manly",   20L,   26L,
"Partly cloudy.",    "Mount Gravatt",   17L,   28L,
"Possible shower.",            "Oxley",   17L,   30L,
"Partly cloudy.",        "Redcliffe",   19L,   27L
)
cdc <- tibble::tribble(
~Year,    ~Reported_Cases,
"Partly cloudy.",         "Brisbane",
"Partly cloudy.", "Brisbane Airport",
"Possible shower.",       "Beaudesert",
"Partly cloudy.",        "Chermside",
"Shower or two. Possible storm.",           "Gatton",
"Possible shower.",          "Ipswich",
"Partly cloudy.",    "Logan Central",
"Mostly sunny.",            "Manly",
"Partly cloudy.",    "Mount Gravatt",
"Possible shower.",            "Oxley",
"Partly cloudy.",        "Redcliffe"
)
cdc <- tibble::tribble(
~Year,    ~Reported_Cases,
1922,	107473,
1923,	164191,
1924,	165418,
1925,	152003,
1926,	202210,
1927,	181411,
1928,	161799,
1929,	197371,
1930,	166914,
1931,	172559,
1932,	215343,
1933,	179135,
1934,	265269,
1935,	180518,
1936,	147237,
1937,	214652,
1938,	227319,
1939,	103188,
1940,	183866,
1941,	222202,
1942,	191383,
1943,	191890,
1944,	109873,
1945,	133792,
1946,	109860,
1947,	156517,
1948,	74715,
1949,	69479,
1950,	120718,
1951,	68687,
1952,	45030,
1953,	37129,
1954,	60886,
1955,	62786,
1956,	31732,
1957,	28295,
1958,	32148,
1959,	40005,
1960,	14809,
1961,	11468,
1962,	17749,
1963,	17135,
1964,	13005,
1965,	6799,
1966,	7717,
1967,	9718,
1968,	4810,
1969,	3285,
1970,	4249,
1971,	3036,
1972,	3287,
1973,	1759,
1974,	2402,
1975,	1738,
1976,	1010,
1977,	2177,
1978,	2063,
1979,	1623,
1980,	1730,
1981,	1248,
1982,	1895,
1983,	2463,
1984,	2276,
1985,	3589,
1986,	4195,
1987,	2823,
1988,	3450,
1989,	4157,
1990,	4570,
1991,	2719,
1992,	4083,
1993,	6586,
1994,	4617,
1995,	5137,
1996,	7796,
1997,	6564,
1998,	7405,
1999,	7298,
2000,	7867,
2001,	7580,
2002,	9771,
2003,	11647,
2004,	25827,
2005,	25616,
2006,	15632,
2007,	10454,
2008,	13278,
2009,	16858,
2010,	27550,
2011,	18719,
2012,	48277,
2013,	28639,
2014,	32971,
2015,	20762,
2016,	17972,
2017,	18975,
2018,	15609,
2019,	18617
)
cdc
ggplot(cdc) +
aes(x=Year, X=Reported_Cases) +
geom_point() +
geom_line() +
labs(x="Year",y="Number of Cases",title="Pertussis Cases by Year")
library(ggplot2)
ggplot(cdc) +
aes(x=Year, X=Reported_Cases) +
geom_point() +
geom_line() +
labs(x="Year",y="Number of Cases",title="Pertussis Cases by Year")
ggplot(cdc) +
aes(x=Year, y=Reported_Cases) +
geom_point() +
geom_line() +
labs(x="Year",y="Number of Cases",title="Pertussis Cases by Year")
library(ggplot2)
ggplot(cdc) +
aes(x=Year, y=Reported_Cases) +
geom_point() +
geom_line() +
labs(x="Year",y="Number of Cases",title="Pertussis Cases by Year") +
geom_vline(xintercept=1946) +
geom_text("wP")
ggplot(cdc) +
aes(x=Year, y=Reported_Cases) +
geom_point() +
geom_line() +
labs(x="Year",y="Number of Cases",title="Pertussis Cases by Year") +
geom_vline(xintercept=1946,aes(geom_text("wP")))
ggplot(cdc) +
aes(x=Year, y=Reported_Cases) +
geom_point() +
geom_line() +
labs(x="Year",y="Number of Cases",title="Pertussis Cases by Year") +
geom_vline(xintercept=1946,aes(color="blue"))
ggplot(cdc) +
aes(x=Year, y=Reported_Cases) +
geom_point() +
geom_line() +
labs(x="Year",y="Number of Cases",title="Pertussis Cases by Year") +
geom_vline(xintercept=1946,color="blue")
ggplot(cdc) +
aes(x=Year, y=Reported_Cases) +
geom_point() +
geom_line() +
labs(x="Year",y="Number of Cases",title="Pertussis Cases by Year") +
geom_vline(xintercept=1946,color="blue") +
geom_vline(xintercept=1996,color="red")
install.packages("jsonlite")
library(jsonlite)
subject <- read_json("https://www.cmi-pb.org/api/subject", simplifyVector = TRUE)
head(subject, 3)
table(subject$infancy_vac)
table(subject$biological_sex)
table(subject$race)
table(subject$race,subject$biological_sex)
table(subject$biological_sex,subject$race)
table(subject$race,subject$biological_sex)
library(lubridate)
# i) average age of wP individuals
wP <- subset(subject,infancy_vac == "wP")
wP
wP['today_age'] <- time_length( today() - year_of_birth,  "years")
wP['today_age'] <- time_length( today() - wP$year_of_birth,  "years")
time_length( today() - wP$year_of_birth,  "years")
wP$year_of_birth
today() - wP$year_of_birth
today() - wP$year_of_birth
wP['age'] <- today() - ymd(wP$year_of_birth)
wP
library(lubridate)
# i) average age of wP individuals
wP <- subset(subject,infancy_vac == "wP")
wP['age_days'] <- today() - ymd(wP$year_of_birth)
wP
wP['age_years'] <- time_length( today() - ymd(wP$year_of_birth),  "years")
wP
wP['age_years'] <- round(time_length( today() - ymd(wP$year_of_birth),  "years"))
wP
summary(wP$age_years)
# ii) average age of aP individuals
aP <- subset(subject,infancy_vac == "wP")
aP['age_days'] <- today() - ymd(aP$year_of_birth)
aP['age_years'] <- round(time_length( today() - ymd(aP$year_of_birth),  "years"))
summary(aP$age_years)
# ii) average age of aP individuals
aP <- subset(subject,infancy_vac == "aP")
aP['age_days'] <- today() - ymd(aP$year_of_birth)
aP['age_years'] <- round(time_length( today() - ymd(aP$year_of_birth),  "years"))
summary(aP$age_years)
subject['age_at_boost'] <- ymd(subject$date_of_boost) - ymd(subject$year_of_birth)
subject['age_at_boost']
subject['age_at_boost'] <- round(time_legnth(ymd(subject$date_of_boost) - ymd(subject$year_of_birth),"years"))
subject['age_at_boost'] <- round(time_length(ymd(subject$date_of_boost) - ymd(subject$year_of_birth),"years"))
subject['age_at_boost']
ggplot(subject) +
aes(time_length(age, "year"),
fill=as.factor(infancy_vac)) +
geom_histogram(show.legend=FALSE) +
facet_wrap(vars(infancy_vac), nrow=2)
# Or use wilcox.test()
x <- t.test(wP$age_years,aP$age_years)
x$p.value
# Or use wilcox.test()
x <- t.test(wP$age_years,aP$age_years)
x$p.value
x <- t.test(wP$age_years,aP$age_years)
x$p.value
# Complete the API URLs...
specimen <- read_json("___/specimen", simplifyVector = TRUE)
# Complete the API URLs...
specimen <- read_json("https://www.cmi-pb.org/api/specimen", simplifyVector = TRUE)
titer <- read_json("https://www.cmi-pb.org/api/titer", simplifyVector = TRUE)
titer <- read_json("https://www.cmi-pb.org/api/titre", simplifyVector = TRUE)
titer <- read_json("https://www.cmi-pb.org/api/ab_titer", simplifyVector = TRUE)
# join datasets
library(dplyr)
meta <- full_join(specimen, subject)
dim(meta)
head(meta)
# join meta and titer
abdata <- inner_join(titer, meta)
dim(abdata)
table(abdata$isotype)
table(abdata$visit)
ig1 <- abdata %>% filter(isotype == "IgG1", visit!=8)
head(ig1)
ggplot(ig1) +
aes(titer, antigen) +
geom_boxplot() +
facet_wrap(vars(visit), nrow=2)
ggplot(ig1) +
aes(ab_titer, antigen) +
geom_boxplot() +
facet_wrap(vars(visit), nrow=2)
View(ig1)
ggplot(ig1) +
aes(MFI, antigen) +
geom_boxplot() +
facet_wrap(vars(visit), nrow=2)
ggplot(ig1) +
aes(ab_titer, antigen, col=infancy_vac ) +
geom_boxplot(show.legend = FALSE) +
facet_wrap(vars(visit), nrow=2) +
theme_bw()
ggplot(ig1) +
aes(FMI, antigen, col=infancy_vac ) +
geom_boxplot(show.legend = FALSE) +
facet_wrap(vars(visit), nrow=2) +
theme_bw()
ggplot(ig1) +
aes(ab_titer, antigen, col=infancy_vac ) +
geom_boxplot(show.legend = FALSE) +
facet_wrap(vars(visit), nrow=2) +
theme_bw()
ggplot(ig1) +
aes(MFI, antigen, col=infancy_vac ) +
geom_boxplot(show.legend = FALSE) +
facet_wrap(vars(visit), nrow=2) +
theme_bw()
ggplot(ig1) +
aes(MFI, antigen, col=infancy_vac ) +
geom_boxplot(show.legend = FALSE) +
facet_wrap(vars(infancy_vac, visit), nrow=2)
ggplot(ig1) +
aes(MFI, antigen, col=infancy_vac ) +
geom_boxplot(show.legend = FALSE) +
facet_wrap(vars(infancy_vac, visit), nrow=2) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
filter(ig1, antigen=="TT") %>%
ggplot() +
aes(ab_titer, col=infancy_vac) +
geom_boxplot(show.legend = TRUE) +
facet_wrap(vars(visit)) +
theme_bw()
filter(ig1, antigen=="TT") %>%
ggplot() +
aes(MFI, col=infancy_vac) +
geom_boxplot(show.legend = TRUE) +
facet_wrap(vars(visit)) +
theme_bw()
filter(ig1, antigen=="FIM2/3") %>%
ggplot() +
aes(MFI, col=infancy_vac) +
geom_boxplot(show.legend = TRUE) +
facet_wrap(vars(visit)) +
theme_bw()
url <- "https://www.cmi-pb.org/api/v2/rnaseq?versioned_ensembl_gene_id=eq.ENSG00000211896.7"
rna <- read_json(url, simplifyVector = TRUE)
ssrna <- inner_join(rna, meta)
ggplot(ssrna) +
aes(x=visit, y=tpm, group=subject_id) +
geom_point() +
geom_line(alpha=0.2)
ggplot(ssrna) +
aes(tpm, col=infancy_vac) +
geom_boxplot() +
facet_wrap(vars(visit))
ssrna %>%
filter(visit==4) %>%
ggplot() +
aes(tpm, col=infancy_vac) + geom_density() +
geom_rug()
